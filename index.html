<!doctype html>  
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pega Pernilongos</title>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#4f8cff">

<!-- Meta do Google AdSense -->
<meta name="google-adsense-account" content="ca-pub-3403987938490863">

<!-- C√≥digo do Google AdSense tradicional -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3403987938490863"
     crossorigin="anonymous"></script>

<style>
  html, body { margin:0; padding:0; height:100%; background:#000; color:#fff; font-family:Arial, sans-serif; }
  body { display:flex; flex-direction:column; align-items:center; text-align:center; }

  canvas { display:block; touch-action:none; position:absolute; top:0; left:0; z-index:6; }

  h1 {
    position:fixed; top:10px; width:100%; text-align:center; font-size:2.5em; margin:0;
    animation: pulse 1.5s infinite alternate; color:#ff4444; z-index:3; pointer-events:none;
  }
  @keyframes pulse { 0%{transform:scale(1);color:#ff4444;} 100%{transform:scale(1.2);color:#ff8888;} }

  #score { position:fixed; top:70px; width:100%; text-align:center; font-size:1.3em; color:#0f0; z-index:3; }

  #startBtn {
    margin:auto; margin-top:150px; padding:15px 30px; font-size:1.2em;
    border:none; border-radius:10px; cursor:pointer; background:#ff4444; color:white; z-index:8;
  }
  #startBtn:hover { background:#ff2222; }

  #controls { position:fixed; top:140px; width:100%; display:flex; justify-content:center; gap:10px; z-index:8; }
  button{ padding:8px 14px; border-radius:6px; border:none; background:#222; color:#fff; cursor:pointer; }
  button:hover { background:#444; }

  #ranking {
    position:fixed; top:190px; left:10px; text-align:left; background:rgba(20,20,20,0.7);
    padding:10px; border-radius:8px; font-size:0.9em; z-index:3;
  }
  #ranking h3{margin:0 0 5px 0;font-size:1em;color:#ffcc00;} 
  #ranking ul{list-style:none;margin:0;padding:0;} 
  #ranking li{margin:2px 0;}

  footer { position:fixed; bottom:60px; width:100%; text-align:center; font-size:0.9em; color:#888; z-index:3; pointer-events:none; }

  #mensagem {
    position:fixed; top:50%; left:50%; transform:translate(-50%,-50%);
    background:rgba(0,0,0,0.8); color:#0ff; padding:20px 30px; border-radius:12px; font-size:1.4em;
    display:none; z-index:10; animation: fadeInOut 5s forwards;
  }
  @keyframes fadeInOut { 0%{opacity:0;} 10%{opacity:1;} 90%{opacity:1;} 100%{opacity:0;} }

  #finalScreen {
    position:fixed; top:50%; left:50%; transform:translate(-50%,-50%);
    text-align:center; display:none; z-index:20; color:#ffd700;
  }
  #finalScreen img { max-width:200px; display:block; margin:0 auto 20px; }
  #finalScreen h2 { font-size:2em; }

  /* Banner in-page fixado abaixo do rodap√© */
  #adBanner {
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
    text-align: center;
    z-index: 9;
    background: #000;
    padding: 2px 0; /* altura reduzida em 60% */
  }
  #adBanner ins.adsbygoogle {
    display: block;
    margin: 0 auto;
    max-height: 40px; /* limita altura */
    overflow: hidden;
  }
</style>
</head>
<body>

<h1>ü¶ü Pega Pernilongos</h1>
<div id="score">Pontos: 0</div>
<button id="startBtn">Iniciar Jogo</button>

<div id="ranking"><h3>üèÜ Ranking</h3><ul id="rankingList"></ul></div>
<div id="controls" style="display:none;"><button id="reset">Reiniciar</button><button id="mute">Mute</button></div>
<div id="mensagem"></div>

<!-- Tela final -->
<div id="finalScreen">
  <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/5a/Trophy_icon.svg/512px-Trophy_icon.svg.png" alt="Ta√ßa Campe√£o">
  <h2 id="finalMsg"></h2>
</div>

<footer>üéÆEDCELL-TECH</footer>
<canvas id="c"></canvas>

<!-- Banner in-page do AdSense -->
<div id="adBanner">
  <ins class="adsbygoogle"
       style="display:block; margin:0 auto;"
       data-ad-client="ca-pub-3403987938490863"
       data-ad-slot="1234567890"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
</div>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

<script>
const canvas=document.getElementById('c'); const ctx=canvas.getContext('2d');
let W,H; function resizeCanvas(){canvas.width=window.innerWidth;canvas.height=window.innerHeight;W=canvas.width;H=canvas.height;} 
window.addEventListener("resize",resizeCanvas); resizeCanvas();

let mosquitoes=[]; const splats=[]; let mute=false,running=false,score=0,playerName="";

const frases=["Reflexo de √°guia!","N√£o teve chance!","Voc√™ est√° voando!","Pernilongo abatido!","Ca√ßador nato!","Acertou em cheio!","Mira incr√≠vel!","R√°pido demais!","Impar√°vel!","Boa ca√ßada!"];

function getRanking(){return JSON.parse(localStorage.getItem("ranking")||"[]");}
function saveRanking(r){localStorage.setItem("ranking",JSON.stringify(r));}
function updateRankingDisplay(){const list=document.getElementById("rankingList");list.innerHTML="";getRanking().forEach(r=>{const li=document.createElement("li");li.textContent=`${r.name}: ${r.points}`;list.appendChild(li);});}
function addScore(name,points){let ranking=getRanking();ranking.push({name,points});ranking.sort((a,b)=>b.points-a.points);ranking=ranking.slice(0,5);saveRanking(ranking);updateRankingDisplay();}
updateRankingDisplay();

function newMosquito(){
  const types=["zigzag","horizontal","vertical"];
  const type=types[Math.floor(Math.random()*types.length)];
  
  // Nasce pr√≥ximo ao centro da tela
  const startX = W/2 + (Math.random()*100 - 50); 
  const startY = H/2 + (Math.random()*100 - 50);

  // Vetor de movimento inicial apontando para fora (extremidades)
  const angle = Math.random() * Math.PI * 2;
  const speed = 80 + Math.random()*100;
  const vx = Math.cos(angle) * speed;
  const vy = Math.sin(angle) * speed;

  return { x:startX, y:startY, vx:vx, vy:vy, scale:1.5, alive:true, wiggle:Math.random()*10, type:type, t:0 };
}

function drawMosquito(ctx,x,y,scale){ctx.save();ctx.translate(x,y);ctx.scale(scale,scale);
ctx.beginPath();ctx.ellipse(0,0,6,18,0,0,Math.PI*2);ctx.fillStyle='#fff';ctx.fill();
ctx.beginPath();ctx.ellipse(-6,-6,18,10,-0.6,0,Math.PI*2);ctx.fillStyle='rgba(200,200,255,0.75)';ctx.fill();
ctx.beginPath();ctx.ellipse(6,-6,18,10,0.6,0,Math.PI*2);ctx.fillStyle='rgba(200,200,255,0.7)';ctx.fill();
ctx.beginPath();ctx.arc(0,12,4,0,Math.PI*2);ctx.fillStyle='#ccc';ctx.fill();ctx.restore();}
function createSplat(x,y){const droplets=[];for(let i=0;i<8;i++){const angle=Math.random()*Math.PI*2;const r=10+Math.random()*20;droplets.push({x:x+Math.cos(angle)*r,y:y+Math.sin(angle)*r,r:2+Math.random()*6,life:1});}splats.push({x,y,t:0,droplets});}

let audioCtx,buzzOsc,buzzGain;
function initAudio(){audioCtx=new (window.AudioContext||window.webkitAudioContext)();buzzOsc=audioCtx.createOscillator();buzzGain=audioCtx.createGain();buzzOsc.type='sawtooth';buzzGain.gain.setValueAtTime(0.03,audioCtx.currentTime);buzzOsc.connect(buzzGain);buzzGain.connect(audioCtx.destination);buzzOsc.start();}
function updateBuzzFrequency(){if(!mute&&running){const freq=800+Math.sin(performance.now()/50)*30+Math.random()*50;buzzOsc.frequency.setValueAtTime(freq,audioCtx.currentTime);}else{if(audioCtx) buzzOsc.frequency.setValueAtTime(0,audioCtx.currentTime);}}
function playHitSound(){if(mute||!running) return;const osc=audioCtx.createOscillator();const gain=audioCtx.createGain();osc.type='square';osc.frequency.setValueAtTime(150,audioCtx.currentTime);gain.gain.setValueAtTime(0.1,audioCtx.currentTime);osc.connect(gain);gain.connect(audioCtx.destination);osc.start();osc.stop(audioCtx.currentTime+0.1);}

function mostrarMensagem(txt){const msg=document.getElementById("mensagem");msg.textContent=txt;msg.style.display="block";msg.style.animation="none";msg.offsetHeight;msg.style.animation="fadeInOut 5s forwards";setTimeout(()=>{msg.style.display="none";},5000);}

function requiredMosquitoes(){return Math.min(1+Math.floor(score/100),10);} 
function checkSpawn(){while(mosquitoes.length<requiredMosquitoes()){mosquitoes.push(newMosquito());}}

function update(dt){if(!running) return;updateBuzzFrequency();
mosquitoes.forEach(m=>{if(m.alive){m.t+=dt*2;
  if(m.type==="zigzag"){ m.x+=Math.cos(m.t*3)*120*dt + m.vx*dt; m.y+=Math.sin(m.t*5)*110*dt + m.vy*dt; }
  else if(m.type==="horizontal"){ m.x+=Math.cos(m.t*2)*120*dt + m.vx*dt*0.2; m.y+=Math.sin(m.t*0.5)*20*dt; }
  else if(m.type==="vertical"){ m.y+=Math.sin(m.t*3)*120*dt + m.vy*dt*0.2; m.x+=Math.cos(m.t*0.5)*20*dt; }
  if(m.x<-40)m.x=W+40;if(m.x>W+40)m.x=-40;if(m.y<-40)m.y=H+40;if(m.y>H+40)m.y=-40; }});
for(let s of splats){s.t+=dt;for(let d of s.droplets)d.life-=dt*0.9;}for(let i=splats.length-1;i>=0;i--){if(splats[i].t>2.2)splats.splice(i,1);}checkSpawn();
if(score>=1000){running=false;document.getElementById("finalMsg").textContent=`Matador de Pernilongo do Gamer ${playerName}!`;document.getElementById("finalScreen").style.display="block";}}
function render(){ctx.clearRect(0,0,W,H);for(let s of splats){const alpha=Math.max(0,1-s.t/1.5);ctx.save();ctx.globalAlpha=alpha;const grad=ctx.createRadialGradient(s.x,s.y,2,s.x,s.y,50);grad.addColorStop(0,'rgba(180,0,20,0.95)');grad.addColorStop(1,'rgba(120,0,18,0.65)');ctx.fillStyle=grad;ctx.beginPath();ctx.ellipse(s.x,s.y,30,15,0,0,Math.PI*2);ctx.fill();for(let d of s.droplets){if(d.life>0){ctx.beginPath();ctx.ellipse(d.x,d.y,d.r,d.r*0.6,0,0,Math.PI*2);ctx.fillStyle='rgba(200,0,0,'+alpha+')';ctx.fill();}}ctx.restore();}
if(running){mosquitoes.forEach(m=>{if(m.alive)drawMosquito(ctx,m.x,m.y,m.scale);});}}

let last=performance.now();
function loop(now){const dt=Math.min(0.05,(now-last)/1000);last=now;update(dt);render();requestAnimationFrame(loop);}
requestAnimationFrame(loop);

// Ajuste: novo vetor aleat√≥rio ao nascer
canvas.addEventListener('pointerdown',(e)=>{
if(!running) return;
const rect=canvas.getBoundingClientRect(); const x=e.clientX-rect.left; const y=e.clientY-rect.top;
mosquitoes.forEach((m)=>{
  if(m.alive){
    const dx=x-m.x,dy=y-m.y;
    if((dx*dx/400+dy*dy/676)<=1){
      createSplat(m.x,m.y); playHitSound(); score++;
      document.getElementById("score").textContent="Pontos: "+score;
      if(score%10===0){ const frase=frases[Math.floor(Math.random()*frases.length)]; mostrarMensagem(frase); }

      // Ao nascer, direciona aleatoriamente para extremidades
      const angle = Math.random() * Math.PI * 2;
      const speed = 80 + Math.random()*200;
      m.vx = Math.cos(angle) * speed;
      m.vy = Math.sin(angle) * speed;
      // Posiciona pr√≥ximo ao centro novamente
      m.x = W/2 + (Math.random()*100 - 50);
      m.y = H/2 + (Math.random()*100 - 50);
    }
  }
});
});

document.getElementById('reset').addEventListener('click',()=>{if(running){addScore(playerName,score);score=0;document.getElementById("score").textContent="Pontos: 0";mosquitoes=[];checkSpawn();}});
document.getElementById('mute').addEventListener('click',()=>{mute=!mute;});
document.getElementById('startBtn').addEventListener('click',()=>{
playerName=prompt("Digite seu nome:")||"An√¥nimo";
initAudio(); running=true; score=0;
document.getElementById("score").textContent="Pontos: 0"; mosquitoes=[]; checkSpawn();
document.getElementById('startBtn').style.display="none"; document.getElementById('controls').style.display="flex";
});
</script>

<!-- Service Worker -->
<script>
if ("serviceWorker" in navigator) {
  window.addEventListener("load", () => {
    navigator.serviceWorker
      .register("./service-worker.js")
      .then(reg => console.log("‚úÖ Service Worker registrado:", reg))
      .catch(err => console.warn("‚ùå Falha ao registrar SW:", err));
  });
}
</script>

</body>
</html>
